# ğŸ‰ XYBotV2 è‡ªåŠ¨æ€»ç»“æ’ä»¶ (AutoSummary) ğŸ‰


å¿«é€Ÿæ€»ç»“æ–‡æœ¬å†…å®¹å’Œå¡ç‰‡æ¶ˆæ¯ï¼Œè®©ä½ çš„ XYBotV2 ç¬é—´å˜èº«æ•ˆç‡åŠ©æ‰‹ï¼ğŸš€

## âœï¸ æ’ä»¶æè¿°

`AutoSummary` æ˜¯ä¸€æ¬¾ä¸º XYBotV2 è®¾è®¡çš„æ’ä»¶ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·**å¿«é€Ÿæ€»ç»“**å¾®ä¿¡èŠå¤©ä¸­çš„**æ–‡æœ¬å†…å®¹**å’Œ**å¡ç‰‡æ¶ˆæ¯**ã€‚å®ƒèƒ½å¤Ÿï¼š

* âœ¨ **è‡ªåŠ¨æå–æ–‡æœ¬æ¶ˆæ¯ä¸­çš„é“¾æ¥**ï¼Œå¹¶æŠ“å–ç½‘é¡µå†…å®¹è¿›è¡Œæ€»ç»“ã€‚
* ğŸ“° **è§£æå¾®ä¿¡å¡ç‰‡æ¶ˆæ¯ (XML æ¶ˆæ¯)**ï¼Œä¾‹å¦‚å…¬ä¼—å·æ–‡ç« åˆ†äº«ç­‰ï¼Œå¹¶è¿›è¡Œå†…å®¹æ¦‚æ‹¬ã€‚
* ğŸ¤– **é›†æˆ Dify API**ï¼Œåˆ©ç”¨å¼ºå¤§çš„ AI èƒ½åŠ›ç”Ÿæˆé«˜è´¨é‡çš„æ‘˜è¦ã€‚
* ğŸ›¡ï¸ **æ”¯æŒé»‘åå•å’Œç™½åå•**ï¼Œçµæ´»æ§åˆ¶æ’ä»¶å¤„ç†çš„é“¾æ¥èŒƒå›´ã€‚

æ— è®ºæ˜¯å¿«é€Ÿäº†è§£ç¾¤å†…åˆ†äº«çš„æ–‡ç« å†…å®¹ï¼Œè¿˜æ˜¯æ¦‚æ‹¬é•¿ç¯‡å¯¹è¯çš„é‡ç‚¹ï¼Œ`AutoSummary` éƒ½èƒ½å¸®ä½ èŠ‚çœå®è´µçš„æ—¶é—´ï¼

## ğŸ‘¨â€ğŸ’» ä½œè€…

* è€å¤çš„é‡‘åº“

## ğŸŒŸ æ’ä»¶ç‰¹æ€§

* **å¤šç§å†…å®¹æ€»ç»“**:
    * **æ–‡æœ¬æ¶ˆæ¯ ğŸ“**: è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬æ¶ˆæ¯ä¸­çš„ URL é“¾æ¥ï¼Œå¹¶è¿›è¡Œç½‘é¡µå†…å®¹æ€»ç»“ã€‚
    * **å¡ç‰‡æ¶ˆæ¯ ğŸ“°**:  æ”¯æŒè§£æå’Œæ€»ç»“å¾®ä¿¡å¡ç‰‡æ¶ˆæ¯ (XML æ ¼å¼)ï¼Œä¾‹å¦‚å¾®ä¿¡å…¬ä¼—å·æ–‡ç« åˆ†äº«ã€å°ç¨‹åºå¡ç‰‡ç­‰ã€‚
* **å¼ºå¤§çš„ AI æ‘˜è¦ ğŸ§ **:  æ·±åº¦é›†æˆ [Dify API](https://dify.ai/)ï¼Œåˆ©ç”¨å…ˆè¿›çš„ AI æ¨¡å‹ç”Ÿæˆç²¾å‡†ã€ç®€æ´çš„æ‘˜è¦ï¼Œè®©æ‚¨å¿«é€ŸæŠ“ä½é‡ç‚¹ã€‚
* **çµæ´»çš„ URL è¿‡æ»¤ ğŸ”—**:
    * **ç™½åå•æœºåˆ¶ âšª**:  åªæ€»ç»“ç™½åå•åŸŸåä¸‹çš„é“¾æ¥ï¼Œæ›´ç²¾å‡†åœ°æ§åˆ¶æ’ä»¶ä½œç”¨èŒƒå›´ã€‚
    * **é»‘åå•æœºåˆ¶ âš«**:  æ’é™¤é»‘åå•åŸŸåä¸‹çš„é“¾æ¥ï¼Œé¿å…æ€»ç»“ä¸æ„Ÿå…´è¶£çš„å†…å®¹ã€‚
* **å¯é…ç½®å‚æ•° âš™ï¸**:  é€šè¿‡ `config.toml` æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥è‡ªå®šä¹‰ Dify API é…ç½®ã€é»‘ç™½åå•ã€æœ€å¤§æ–‡æœ¬é•¿åº¦ç­‰å‚æ•°ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–éœ€æ±‚ã€‚
* **å¼‚æ­¥å¤„ç† â±ï¸**:  é‡‡ç”¨ `asyncio` å¼‚æ­¥æ¡†æ¶ï¼Œä¿è¯æ’ä»¶é«˜æ•ˆè¿è¡Œï¼Œä¸é˜»å¡ XYBotV2 ä¸»ç¨‹åºã€‚
* **è¯¦ç»†æ—¥å¿— è®°å½• ğŸªµ**:  ä½¿ç”¨ `loguru` è®°å½•è¯¦ç»†æ—¥å¿—ï¼Œæ–¹ä¾¿é—®é¢˜æ’æŸ¥å’Œæ’ä»¶ç›‘æ§ã€‚

## ğŸ› ï¸ å®‰è£…æ•™ç¨‹

1. **ä¸‹è½½æ’ä»¶**ï¼šå°† `AutoSummary` æ’ä»¶æ–‡ä»¶å¤¹æ”¾å…¥ XYBotV2 çš„ `plugins` ç›®å½•ä¸‹ã€‚
2. **é…ç½®æ’ä»¶**ï¼šä¿®æ”¹ `plugins/AutoSummary/config.toml` æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„ Dify API ç›¸å…³é…ç½®ä»¥åŠå…¶ä»–è‡ªå®šä¹‰è®¾ç½®ã€‚
3. **é‡å¯ XYBotV2**ï¼šé‡å¯æ‚¨çš„ XYBotV2 æœºå™¨äººï¼Œæ’ä»¶å³å¯ç”Ÿæ•ˆã€‚

## âš™ï¸ é…ç½®æ–‡ä»¶ (config.toml)

æ‚¨éœ€è¦åœ¨ `plugins/AutoSummary/config.toml` æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

```toml
[AutoSummary]
enable = true

[AutoSummary.Dify]
enable = true
api-key = "app-7r0xBzXNaBEQjBJks0N6wdJO"  # è¯·æ›¿æ¢ä¸ºå®é™…çš„ API Key
base-url = "[http://192.168.6.19:8080/v1](http://192.168.6.19:8080/v1)"  # è¯·æ›¿æ¢ä¸ºå®é™…çš„ API URL
http-proxy = ""  # å¦‚æœéœ€è¦ä»£ç†å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®

[AutoSummary.Settings]
max_text_length = 8000  # æœ€å¤§æ–‡æœ¬é•¿åº¦
black_list = [  # é»‘åå•URL
    "[https://support.weixin.qq.com](https://support.weixin.qq.com)",
    "[https://channels-aladin.wxqcloud.qq.com](https://channels-aladin.wxqcloud.qq.com)"
]
white_list = []  # ç™½åå•URLï¼Œä¸ºç©ºåˆ™å…è®¸æ‰€æœ‰éé»‘åå•URL
```

**é…ç½®è¯´æ˜:**

* â€‹**`[AutoSummary.Dify]`**â€‹:  Dify API ç›¸å…³é…ç½®ã€‚
  * `enable`:  â€‹**æ˜¯å¦å¯ç”¨ Dify æ‘˜è¦åŠŸèƒ½**â€‹ã€‚è®¾ç½®ä¸º `true` å¯ç”¨ï¼Œ`false` ç¦ç”¨ã€‚ç¦ç”¨åï¼Œæ’ä»¶å°†æ— æ³•ç”Ÿæˆæ‘˜è¦ã€‚
  * `api-key`:  â€‹**æ‚¨çš„ Dify API Key**â€‹ã€‚å¦‚æœæ‚¨å¯ç”¨äº† Dify æ‘˜è¦åŠŸèƒ½ (`enable = true`)ï¼Œåˆ™å¿…é¡»å¡«å†™æ‚¨çš„ Dify API Keyã€‚
  * `base-url`:  â€‹**æ‚¨çš„ Dify API Base URL**â€‹ã€‚å¦‚æœæ‚¨å¯ç”¨äº† Dify æ‘˜è¦åŠŸèƒ½ (`enable = true`)ï¼Œåˆ™å¿…é¡»å¡«å†™æ‚¨çš„ Dify API Base URLã€‚ é€šå¸¸æ˜¯æ‚¨çš„ Dify æœåŠ¡åœ°å€ï¼Œä¾‹å¦‚ `http://localhost:8000` æˆ–æ‚¨çš„ Dify äº‘æœåŠ¡åœ°å€ã€‚
  * `http-proxy`:  â€‹**HTTP ä»£ç†è®¾ç½® (å¯é€‰)**â€‹ã€‚å¦‚æœæ‚¨éœ€è¦é€šè¿‡ HTTP ä»£ç†è®¿é—® Dify APIï¼Œè¯·åœ¨æ­¤å¤„å¡«å†™ä»£ç†åœ°å€ã€‚
* â€‹**`[AutoSummary.Settings]`**â€‹: æ’ä»¶é€šç”¨è®¾ç½®ã€‚
  * `max_text_length`:  â€‹**æœ€å¤§æ–‡æœ¬é•¿åº¦**â€‹ã€‚é™åˆ¶å‘é€ç»™ Dify API è¿›è¡Œæ€»ç»“çš„æ–‡æœ¬é•¿åº¦ï¼Œé˜²æ­¢å†…å®¹è¿‡é•¿å¯¼è‡´ API è°ƒç”¨å¤±è´¥æˆ–æ¶ˆè€—è¿‡å¤šèµ„æºã€‚ é»˜è®¤å€¼ä¸º `8000` å­—ç¬¦ã€‚
  * `black_list`:  â€‹**URL é»‘åå•**â€‹ã€‚  æ’ä»¶å°†ä¸ä¼šæ€»ç»“é»‘åå•åˆ—è¡¨ä¸­åŸŸåä¸‹çš„ä»»ä½•é“¾æ¥ã€‚  æ‚¨å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ åŸŸååˆ°æ­¤åˆ—è¡¨ï¼Œä¾‹å¦‚æ‚¨ä¸å¸Œæœ›æ€»ç»“æŸäº›ç‰¹å®šç½‘ç«™çš„å†…å®¹ã€‚
  * `white_list`:  â€‹**URL ç™½åå•**â€‹ã€‚  **åªæœ‰** ç™½åå•åˆ—è¡¨ä¸­çš„åŸŸåä¸‹çš„é“¾æ¥æ‰ä¼šè¢«æ’ä»¶æ€»ç»“ã€‚  å¦‚æœæ­¤åˆ—è¡¨ä¸ºç©ºï¼Œåˆ™ â€‹**ä¸å¯ç”¨ç™½åå•**â€‹ï¼Œæ’ä»¶å°†æ€»ç»“æ‰€æœ‰ **éé»‘åå•** åŸŸåä¸‹çš„é“¾æ¥ã€‚  å¦‚æœæ‚¨å¸Œæœ›æ’ä»¶åªå¤„ç†ç‰¹å®šç½‘ç«™çš„é“¾æ¥ï¼Œå¯ä»¥é…ç½®ç™½åå•ã€‚

## ğŸ’¡ ä½¿ç”¨æ–¹æ³•

1. â€‹**å‘é€æ–‡æœ¬æ¶ˆæ¯åŒ…å« URL é“¾æ¥**â€‹ï¼š å½“ä½ åœ¨å¾®ä¿¡ç¾¤æˆ–ç§èŠä¸­å‘é€åŒ…å« URL é“¾æ¥çš„æ–‡æœ¬æ¶ˆæ¯æ—¶ï¼Œå¦‚æœé“¾æ¥ç¬¦åˆæ’ä»¶çš„è¿‡æ»¤è§„åˆ™ (éé»‘åå•ï¼Œæˆ–åœ¨ç™½åå•å†…)ï¼Œæ’ä»¶å°†è‡ªåŠ¨æŠ“å–ç½‘é¡µå†…å®¹å¹¶ç”Ÿæˆæ‘˜è¦å›å¤ç»™ä½ ã€‚
2. â€‹**æ¥æ”¶åˆ°å¾®ä¿¡å¡ç‰‡æ¶ˆæ¯**â€‹ï¼š å½“ä½ åœ¨å¾®ä¿¡ä¸­æ¥æ”¶åˆ°å¡ç‰‡æ¶ˆæ¯ (ä¾‹å¦‚ï¼Œåˆ«äººåˆ†äº«çš„å¾®ä¿¡å…¬ä¼—å·æ–‡ç« ) æ—¶ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨è§£æå¡ç‰‡å†…å®¹å¹¶å°è¯•ç”Ÿæˆæ‘˜è¦å›å¤ã€‚

**ç¤ºä¾‹å¯¹è¯:**

**ç”¨æˆ·:**  [å‘é€ä¸€æ¡åŒ…å« URL é“¾æ¥çš„æ–‡æœ¬æ¶ˆæ¯]  ä¾‹å¦‚ï¼š  "å¤§å®¶çœ‹çœ‹è¿™ç¯‡æ–‡ç«  [https://example.com/amazing-article](https://www.google.com/url?sa=E&source=gmail&q=https://www.google.com/url?sa=E%26source=gmail%26q=https://example.com/amazing-article)  è®²çš„çœŸä¸é”™ï¼"

**XYBotV2 æœºå™¨äºº:**  ğŸ” æ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆå†…å®¹æ€»ç»“ï¼Œè¯·ç¨å€™...

**XYBotV2 æœºå™¨äºº:**  ğŸ¯ å†…å®¹æ€»ç»“å¦‚ä¸‹ï¼š

> [Dify API ç”Ÿæˆçš„æ–‡ç« æ‘˜è¦å†…å®¹]

**ç”¨æˆ·:**  [åœ¨å¾®ä¿¡ç¾¤ä¸­æ¥æ”¶åˆ°ä¸€å¼ å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å¡ç‰‡æ¶ˆæ¯]

**XYBotV2 æœºå™¨äºº:**  ğŸ” æ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆå†…å®¹æ€»ç»“ï¼Œè¯·ç¨å€™...

**XYBotV2 æœºå™¨äºº:**  ğŸ¯ å¡ç‰‡å†…å®¹æ€»ç»“å¦‚ä¸‹ï¼š

> [Dify API ç”Ÿæˆçš„å¡ç‰‡æ¶ˆæ¯æ‘˜è¦å†…å®¹]

## âš™ï¸ æ›¿æ¢ `utils/xybot.py` (âš ï¸ æ³¨æ„)


## âš ï¸  é‡è¦ä¾èµ–

* [XYBotV2](https://www.google.com/url?sa=E&source=gmail&q=https://github.com/your-xybotv2-repo-link) (è¯·æ›¿æ¢æˆ XYBotV2 çš„å®é™… GitHub ä»“åº“é“¾æ¥) -  æœ¬æ’ä»¶åŸºäº XYBotV2 æ¡†æ¶å¼€å‘ã€‚
* `aiohttp` -  ç”¨äºå¼‚æ­¥ HTTP è¯·æ±‚ã€‚
* `loguru` -  ç”¨äºæ—¥å¿—è®°å½•ã€‚
* `toml`  -  ç”¨äº TOML é…ç½®æ–‡ä»¶è§£æã€‚
* [Dify API](https://www.google.com/url?sa=E&source=gmail&q=https://dify.ai/) -  å¯é€‰ï¼Œç”¨äº AI æ‘˜è¦ç”Ÿæˆã€‚ å¼ºçƒˆå»ºè®®ä½¿ç”¨ä»¥è·å¾—æœ€ä½³æ‘˜è¦æ•ˆæœã€‚

## ğŸ“œ  å…è´£å£°æ˜

* æœ¬æ’ä»¶ä¾èµ–äº [Dify API](https://www.google.com/url?sa=E&source=gmail&q=https://dify.ai/)  æœåŠ¡è¿›è¡Œå†…å®¹æ‘˜è¦ç”Ÿæˆã€‚  â€‹**æ‚¨éœ€è¦è‡ªè¡Œæ³¨å†Œ Dify æœåŠ¡å¹¶è·å– API Keyï¼Œå¹¶å¯èƒ½éœ€è¦æ‰¿æ‹… Dify API çš„ä½¿ç”¨è´¹ç”¨ (å¦‚æœ Dify æœåŠ¡æ˜¯æ”¶è´¹çš„)**â€‹ã€‚
* æ’ä»¶æä¾›çš„æ‘˜è¦ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸èƒ½ä¿è¯å®Œå…¨å‡†ç¡®å’Œå®Œæ•´ã€‚
* è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œå¹³å°ä½¿ç”¨åè®®ï¼Œåˆç†ä½¿ç”¨æœ¬æ’ä»¶ã€‚

## ğŸ¤ è”ç³»æ–¹å¼

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ã€å»ºè®®æˆ–æƒ³å‚ä¸æ’ä»¶å¼€å‘ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ä½œè€…ï¼š

* [ä½ çš„ GitHub ä»“åº“åœ°å€](https://www.google.com/url?sa=E&source=gmail&q=%E4%BD%A0%E7%9A%84GitHub%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80)
* [ä½ çš„é‚®ç®±åœ°å€](https://www.google.com/url?sa=E&source=gmail&q=%E4%BD%A0%E7%9A%84%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80)
* [å…¶ä»–è”ç³»æ–¹å¼]

æ„Ÿè°¢æ‚¨çš„ä½¿ç”¨ï¼â­

![2191ff9b71feb07cac70bf62123275b](https://github.com/user-attachments/assets/1e1b3e0f-fab8-4cc6-9011-3b0e8bf10737)

![2191ff9b71feb07cac70bf62123275b](https://github.com/user-attachments/assets/7d673675-c804-4feb-bbef-ccba6a728e16)

